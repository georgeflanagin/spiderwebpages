.. _torchsw:
.. highlight:: rst

====================================
Torch and Torch Vision
====================================

PyTorch is available in a variety of formats from 
`the PyTorch organization <https://pytorch.org>`_. Additionally, 
there are configurations for different NVIDIA GPUs, and the
inclusion of other parts of the PyTorch ecosystem. 

As of |today|, the instructions generated by the 
`GET STARTED <https://pytorch.org/get-started/locally/>`_ page at
PyTorch's site are 
incorrect, and the instructions below have been shown to work on
the CPUs at UR. 

Installation
----------------

PyTorch recommends using the Anaconda distro, and the following instructions
are for the Anaconda environment. 

We will need to explicitly set the conda channel from which the install
takes place, and to do so, this is the command::

    conda config --set channel_priority false

Because of the large number of dependencies, the second step is to update
all the underlying Anaconda packages::

    conda update --all --yes

This step might take a while, depending on what is present in the environment.

Install the pytorch core explicitly from the pytorch channel::

    conda install -c pytorch pytorch

If GPUs were detected, the appropriate drives for them will be found and included
in the preceding step. We may now install companion parts of pytorch::

    conda install -c pytorch torchvision torchaudio

Upgrade
-----------

The ``install`` command must be changed to ``update``, and all four steps are a wise
idea if anything has been changed since the first installation. Similarly, combining
the pytorch packages into one command will avoid package conflicts because Anaconda 
will consider them as a unit:: 

    conda config --set channel_priority false
    conda update --all --yes
    conda update -c pytorch pytorch torchvision torchaudio
    

